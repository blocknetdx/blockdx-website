---
title: history.meta_title
description: history.meta_description
keywords: history.meta_keywords
layout: default
namespace: history
permalink: /trade-history/
---


{% assign lang = site.translations[site.lang] %}
{% assign baseurl = site.url | append: lang.global.link_index %}

{% 
  include templates/page-header.html
  title=lang.history.title
  intro=lang.history.intro
  button_text=''
  button_link='#stats'
  class='bg-light'
%}

<section class="section bg-light pt-3 pb-1 dx-animate">
  <div class="container">
    <div class="dx-card shadow-sm h-shadow">
      <div class="row">

        <div class="col-md-4">
          <label id="market-dropdown-label" for="market-dropdown">{{ lang.history.select_market }}</label>
          <select id="market-dropdown" class="custom-select">
            <option value="all" selected="selected">{{ lang.history.all_markets_option }}</option>
          </select>
        </div>

        <div class="col-md-4 text-md-center">
          <button id="view-market" type="button" onclick="reloadTable(false)" class="btn btn-primary">{{ lang.history.view_market }}</button>
        </div>

        <div class="col-md-4 text-md-center">
          <button id="inverse-market" type="button" onclick="reloadTable(true)" class="btn btn-white">{{ lang.history.view_inverse_market }}</button>
        </div>

      </div>
    </div>
  </div>
</section>

<section id="history" class="section bg-light pb-0 dx-animate">
  <div class="container"> 
    <div class="row">
      <div class="col-md-12">
        <div class="table-responsive">
          <table class="table shadow-sm">
            <thead class="thead-primary">
              <tr>
                <th>{{ lang.history.table_type }} <span class="trade-type"></span></th>
                <th>{{ lang.history.table_size }} <span class="market-maker"></span></th>
                <th>{{ lang.history.table_price }} <span class="market-price"></span></th>
                <th>{{ lang.history.table_total }} <span class="market-taker"></span></th>
                <th>{{ lang.history.table_time }} <span class="trade-time"></span></th>
              </tr>
            </thead>
            <tbody id="dx-tbody-hist">
                <td>{{ lang.history.message_loading_orders }}</td>
                <td></td>
                <td></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </div>
</section>

<section id="trade-stats" class="section bg-light dx-animate">
  <div class="container"> 
    <div class="row">
      <div class="col-lg-6 offset-lg-3 col-md-8 offset-md-2">
        <a class="twitter-timeline" data-height="800" href="https://twitter.com/DxStats">View daily trade stats.</a>
        <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
      </div>
    </div>
  </div>
</section>




<script type="text/javascript">
  var dev = true;  
  var historyData = [];
  var sampleHistoryData = [
      {
        "timestamp": 1591983995,
        "fee_txid": "163b1f3530581015d29bc3c4d8630ea688700934cbae9af648d93faa6a1fa096",
        "nodepubkey": "BakFLuSW9g48FpQH3fmS7Vu2zJJUN7XwHG",
        "id": "13dc031ec6844b92230a18652f4806f86ca2a1b490c0676d73d6f328993159f7",
        "taker": "BLOCK",
        "taker_size": 17.58581800,
        "maker": "LTC",
        "maker_size": 0.46604600
      },
      {
        "timestamp": 1591983995,
        "fee_txid": "6fd9dab1864afbcd4e85533b897ca2a9ef89b2e645d079dc02db24db836b0b6f",
        "nodepubkey": "BVJSKZG1YTseYGacMu8nRBqFCwhB4HYecw",
        "id": "2ac7d7f819797e3f019a8a0ef554fa2825dc1052aa33b6aa80dfff74c054567e",
        "taker": "BLOCK",
        "taker_size": 100.00000000,
        "maker": "LTC",
        "maker_size": 2.70000000
      },
      {
        "timestamp": 1591919307,
        "fee_txid": "89b58525d886894ce71b72e051842642b7f5b055afb8a1859ace3808a3b608ac",
        "nodepubkey": "BrtXo7Gk4sFUfiWzb1oUropNRDyogTof3g",
        "id": "5da294f77e9799e8f8394f2e8b149e7eb5aa3c6c7885dba10a4795159eeb5edd",
        "taker": "BLOCK",
        "taker_size": 17.06059700,
        "maker": "LTC",
        "maker_size": 0.46102300
      },
      {
        "timestamp": 1591744767,
        "fee_txid": "5765b80eacf6d7e9f66c028d1fa2ea930ac4b11d2e301f7f10cb77fe5853cbc6",
        "nodepubkey": "BUgwDVV8yroaMorvUwKR1ETv7RkjAWczEV",
        "id": "e5d794c3d4627ee58df184cb4e7a24d18b28307e93c8dcf96ef44faf8e23d4ee",
        "taker": "LTC",
        "taker_size": 0.30120000,
        "maker": "BLOCK",
        "maker_size": 12.00000000
      },
      {
        "timestamp": 1591695568,
        "fee_txid": "5c3dddceddff69e526fba1430a065dcdb1048f0218aac599cc174cd332f13f7b",
        "nodepubkey": "BYmz9MkUrvqLis33XM4835wcZfxx7ubzkU",
        "id": "65c71a91aab0b5f44106ff99b435b81a865268ab5a0ace4e80624cbc57fb5c5d",
        "taker": "LTC",
        "taker_size": 0.54200000,
        "maker": "BLOCK",
        "maker_size": 20.00000000
      },
      {
        "timestamp": 1591695518,
        "fee_txid": "d04d5ae1b48ad79981d0a018d7754d14a24933e2afb305cc0c88f360dfb86662",
        "nodepubkey": "BngBQC4Qd6Byk5oMqUXSEtx9kr9uffD6jt",
        "id": "922fcc90881c12a0d1bea5ea15c32695015e70a1728da1a3ed67aa9371a19fb5",
        "taker": "LTC",
        "taker_size": 0.54200000,
        "maker": "BLOCK",
        "maker_size": 20.00000000
      },
      {
        "timestamp": 1591966622,
        "fee_txid": "81c3f391bfcf28808d03f3c56136ffdd6fbbb1aa9898db869535c9eea2bf67c6",
        "nodepubkey": "Bqshd156VexPDKELxido2S2pDvqrRzSCi4",
        "id": "caca1304fbeea171b29a49ca0a3d13443b5e102cf4fdc5853891fbf7d2adf4cd",
        "taker": "BLOCK",
        "taker_size": 10.00000000,
        "maker": "BTC",
        "maker_size": 0.00131000
      },
      {
        "timestamp": 1591277882,
        "fee_txid": "6d3fc0592eee1cd54cac0b18d00ae4db2b2a4a36375f2dcc94ec871def36efa2",
        "nodepubkey": "BeAS1djaiUnQghFA6iCYDAx4eTCXvHhQ2c",
        "id": "ae0daea6a44f530acacb1ed32301ebebd6e7999e4fc7114e0c68939bb0855b0b",
        "taker": "BLOCK",
        "taker_size": 244.14490700,
        "maker": "BTC",
        "maker_size": 0.02905300
      },
      {
        "timestamp": 1590142698,
        "fee_txid": "75990b9d55b381f2310e264705bddfa012e6ecfa5fefc4d6641be4307b3525a6",
        "nodepubkey": "Bqshd156VexPDKELxido2S2pDvqrRzSCi4",
        "id": "a9d73d2097806bf77df0f21a905447199d4203e7bb358f2d4468f75a2a60fd2c",
        "taker": "BLOCK",
        "taker_size": 207.00991800,
        "maker": "BTC",
        "maker_size": 0.02939500
      },
      {
        "timestamp": 1590141208,
        "fee_txid": "8dc76172b1119fdc02f8190730cb1481c8fc874d34e8a0bd6cb706e9bfcd2a6c",
        "nodepubkey": "Bm5xuSjVzw9X1Psnyy1zbZFk6JS4ky3X4S",
        "id": "2123554ee4d832071b265cccc3cb2726586800105b8fe0db6ca8cba6135965d2",
        "taker": "BTC",
        "taker_size": 0.04230000,
        "maker": "BLOCK",
        "maker_size": 300.00000000
      },
      {
        "timestamp": 1591704361,
        "fee_txid": "becade58f8191706f2965119cc5469a10a401dff07a1d8af5e0a26042c8572a3",
        "nodepubkey": "Bk9g3GEexq1fji4ubxLwHMBvaRVikR4jMr",
        "id": "ae46be11b0eed7fc5d3cd4140d615f1bf3db9f7974565d8fb041d15d2ebc8132",
        "taker": "BTC",
        "taker_size": 0.01848700,
        "maker": "BLOCK",
        "maker_size": 137.96559200
      },
      {
        "timestamp": 1591702650,
        "fee_txid": "0d6f64ddfd5ba7dc8920f027ff85b6a6f27b46061e9ed7d21dd5fd3aaee1d4e2",
        "nodepubkey": "BqmBdodNH6nNT96vJ65VrK4SbKgYyDy2fh",
        "id": "880db11dd4d616d1e9d843954a987113a5e8478b75446abfb33fde2efc6c62a6",
        "taker": "BTC",
        "taker_size": 0.02949100,
        "maker": "BLOCK",
        "maker_size": 220.08082500
      },
      {
        "timestamp": 1590709237,
        "fee_txid": "93846ced501e32433b01e6760fc2bbcc621d0e714faa90fe5066548774e8d085",
        "nodepubkey": "BqmBdodNH6nNT96vJ65VrK4SbKgYyDy2fh",
        "id": "14a5f620ffa73d8436481247abd17f78d9dc874f13eba3265ac0bd918d224f56",
        "taker": "BLOCK",
        "taker_size": 14.72939100,
        "maker": "DASH",
        "maker_size": 0.25000000
      },
      {
        "timestamp": 1590047736,
        "fee_txid": "a19fb0fbb74b6c5a8a3279ec05a21a9ee6f6105668fcbf862c7b46a42b43a8fa",
        "nodepubkey": "BgfhG3M9CTFby4VZz59Xza5SxDWFvUhcUe",
        "id": "faeb19d54990a0d0959723f9f0cee62d905b2fd748b83e6a1834fc17c1e88f1e",
        "taker": "BLOCK",
        "taker_size": 15.12800900,
        "maker": "DASH",
        "maker_size": 0.25000000
      },
      {
        "timestamp": 1590046653,
        "fee_txid": "654740729199ee189845bfbe2b5c3a8c417dbcbc9f03c431458d5a1543e938c8",
        "nodepubkey": "BYmz9MkUrvqLis33XM4835wcZfxx7ubzkU",
        "id": "079ea63654944cf482336c7ccc84a7c98e25c13ed5ef228a5872b368f5dbaa5b",
        "taker": "BLOCK",
        "taker_size": 15.15208100,
        "maker": "DASH",
        "maker_size": 0.25000000
      },
      {
        "timestamp": 1589844380,
        "fee_txid": "34c9ac5b1c810c89a4a4b5b3de86c7a343b0f8cae4670f9dc6851fa73c4f69ee",
        "nodepubkey": "BYmz9MkUrvqLis33XM4835wcZfxx7ubzkU",
        "id": "412179311e042b51a9b00fd848ce71c2a5fba7cb739fe4e9b94b6d9ab2e896ce",
        "taker": "DGB",
        "taker_size": 1.50000000,
        "maker": "DOGE",
        "maker_size": 25.00000000
      },
      {
        "timestamp": 1589840415,
        "fee_txid": "397ddf74820dc4680b5ea1d48f5455c3e89cb77f488634deb4b7bb2657552e46",
        "nodepubkey": "Bk9by8cfYYxx8n6FvPSgUzZLm31rDFmNqK",
        "id": "8bebc688494c68977bcb9b3f4e32ea1178f802a0f5985169e65817a91900fbbb",
        "taker": "DGB",
        "taker_size": 1.00000000,
        "maker": "REEX",
        "maker_size": 1.00000000
      }
    ];
  var cgIndex = [];
  var marketList = [];
  var tradeHistory = {};
  var targetMarket = "";
  var bids = [];
  var asks = [];
  var marketHistory = [];
  var loadingTradesMsg = "{{ lang.history.message_loading_trades }}";
  var noTradesMsg = "{{ lang.history.message_no_trades }}";
  var loadingErrMsg = "{{ lang.history.message_loading_error }}";
  var loadingErrAlert = "{{ lang.history.alert_loading_error }}";


  if (dev) {
    processTrades();
  } else {
    getHistAjax().then(processTrades);
  }

  function getHistAjax() {
    var promise = new Promise(function(resolve, reject){
      if (dev) { console.log("getHistAjax"); }
      var xhr = new XMLHttpRequest();
      var status = true;
      xhr.timeout = 2000;  
      xhr.addEventListener("timeout", function(e) {
        console.log("getHistAjax timeout"); 
        alert(loadingErrAlert);
      });
      var url = "https://data.blocknet.co/api/v2.0/history";
      xhr.open('GET', url);
      xhr.send();
      xhr.onreadystatechange = function(){
        if (xhr.readyState === 4) {
          if (xhr.status === 200){
            if (dev) { console.log("getHistAjax success"); }
            var response = JSON.parse(this.responseText);
            historyData = response;
            resolve(response);
          } else {
            console.log("Failed to load history");
            var loadingErr = "<tr><td>" + loadingErrMsg + "</td><td></td><td></td><td></td><tr>";
            document.getElementById("dx-tbody-hist").innerHTML = loadingErr;
            alert(loadingErrAlert);
          }
        }
      }
    });
    return promise;
  }

  function processTrades() {
    var trades;
    if (dev) {
      trades = sampleHistoryData;
      console.log("processTrades");
    } else {
      trades = historyData;
    }
    {% comment %}
      // example trade object 
        // {
        //   "timestamp": 1591983995,
        //   "fee_txid": "163b1f3530581015d29bc3c4d8630ea688700934cbae9af648d93faa6a1fa096",
        //   "nodepubkey": "BakFLuSW9g48FpQH3fmS7Vu2zJJUN7XwHG",
        //   "id": "13dc031ec6844b92230a18652f4806f86ca2a1b490c0676d73d6f328993159f7",
        //   "taker": "BLOCK",
        //   "taker_size": 17.58581800,
        //   "maker": "LTC",
        //   "maker_size": 0.46604600
        // },
    {% endcomment %}
    for(var trade in trades) {
      // var id = trades[trade]["id"];
      // var feeHash = trades[trade]["fee_txid"];
      // var snodeKey = trades[trade]["nodepubkey"];
      var maker = trades[trade]["maker"];
      var taker = trades[trade]["taker"];
      var size = fixedDecimals( trades[trade]["maker_size"] );
      var total = fixedDecimals( trades[trade]["taker_size"] );
      // round price to 6 decimals
      var price = Math.round( Number(trades[trade]["taker_size"]) / Number(trades[trade]["maker_size"]) * 1000000 ) / 1000000;
      price = fixedDecimals(price);
      var epoch = trades[trade]["timestamp"];

      // get local trade time in format: Today at 14:32
      var currentDate = new Date();
      var currentDay = currentDate.getDate();
      var tradeDate = new Date( Number(epoch)*1000 );
      var tradeDay = tradeDate.getDate();
      var tradeHour = tradeDate.getHours();
      var tradeMinute = tradeDate.getMinutes();
      if (currentDay == tradeDay) {
        tradeDay = "{{ lang.history.time_today }}";
      } else if ((Number(currentDay)-1) == tradeDay) {
        tradeDay = "{{ lang.history.time_yesterday }}";
      } else {
        tradeDay = tradeDate.toLocaleString('default', { month: 'short' }) + " " + tradeDay;
      }
      var time = tradeDay + " {{ lang.history.time_at }} " + tradeHour + ":" + tradeMinute;

      // make an array of maker/taker pairs for the market selection dropdown
      var market = maker + "/" + taker ;
      if ( !marketList.includes(market) ) {
        marketList.push(market);
        tradeHistory[market] = [{ "maker": maker, "taker": taker, "size": size, "price": price, "total": total, "time": time, "epoch": epoch }];
      } else {
        tradeHistory[market].push({ "maker": maker, "taker": taker, "size": size, "price": price, "total": total, "time": time, "epoch": epoch });
      }
    }

    // populate the dropdown with markets
    var marketDropdown = document.getElementById("market-dropdown");
    for (var market in marketList) {
      // if (marketList[market] !== "BLOCK/LTC") {
        var option = document.createElement("option");
        option.text = marketList[market];
        option.value = marketList[market];
        marketDropdown.add(option);
      // }
    }
    reloadTable(false);
  }

  function fixedDecimals(val) {
    val = val.toString().split(".");
    var valBase = val[0];
    var valDec = "000000";
    if (val[1] !== undefined ) {
      valDec = (val[1] + "000000").slice(0,6);
    }
    val = valBase + "." + valDec;
    return val;
  }

  function reloadTable(inverse) {
    if (dev) { console.log("reloadTable"); }
    prepareMarketData(inverse).then(updateTable)
  }

  function getMarket() {
    if (dev) { console.log("getMarket"); }
    var dropdown = document.getElementById("market-dropdown");
    var market = dropdown.options[dropdown.selectedIndex].value;
    return market;
  }

  {% comment %}
    // block/ltc market
    //   asks/sells (red)
    //   size = block
    //   price = block/ltc
    //   total = ltc
    //   --
    //   bids/buys (green, ltc/block inversed)
    //   size = block
    //   price = block/ltc
    //   total = ltc

    // ltc/block market
    //   asks/sells (red)
    //   size = ltc
    //   price = ltc/block
    //   total = block
    //   --
    //   bids/buys (green, block/ltc inversed)
    //   size = ltc
    //   price = ltc/block
    //   total = block
  {% endcomment %}

  function prepareMarketData(inverse) {
    var promise = new Promise(function(resolve, reject){
      if (dev) { console.log("prepareMarketData"); }
      var currentMarket;
      var inverseMarket;
      asks = [];
      bids = [];
      marketHistory = [];

      if (getMarket() !== "all") {
        if (inverse) {
          // reverse markets to show inverse
          inverseMarket = getMarket();
          currentMarket = inverseMarket.split("/").reverse().join("/");
          // add inverse market to dropdown if not there already
          var marketDropdown = document.getElementById("market-dropdown");
          if ( !marketList.includes(currentMarket) ) {
            marketList.push(currentMarket);
            var option = document.createElement("option");
            option.text = currentMarket;
            option.value = currentMarket;
            marketDropdown.add(option);
          }
          // update dropdown option
          marketDropdown.value = currentMarket;
        } else {
          // set target markets
          currentMarket = getMarket();
          inverseMarket = currentMarket.split("/").reverse().join("/");
        }
        targetMarket = currentMarket;

        // update table body with loading message
        var tableLoading = "<tr><td>" + loadingTradesMsg + "</td><td></td><td></td><td></td><td></td><tr>";
        document.getElementById("dx-tbody-hist").innerHTML = tableLoading;

        asks = tradeHistory[currentMarket];
        if (asks !== undefined) {
          for (ask in asks) {
            var type = "<div class='sell'>{{ lang.history.type_sell }} <img src='{{ baseurl }}assets/img/arrow-down.svg'/></div>";
            var size = asks[ask]["size"];
            var price = asks[ask]["price"];
            var total = asks[ask]["total"];
            var time = asks[ask]["time"];
            var epoch = asks[ask]["epoch"];
            marketHistory.push({ "type": type, "size": size, "price": price, "total": total, "time": time, "epoch": epoch });
          }
        }

        bids = tradeHistory[inverseMarket];
        if (bids !== undefined) {
          for (bid in bids) {
            var type = "<div class='buy'>{{ lang.history.type_buy }} <img src='{{ baseurl }}assets/img/arrow-up.svg'/></div>";
            var size = bids[bid]["total"];
            var total = bids[bid]["size"];
            var price = Math.round( Number(total) / Number(size) * 1000000 ) / 1000000;
            price = fixedDecimals(price);
            var time = bids[bid]["time"];
            var epoch = bids[bid]["epoch"];
            marketHistory.push({ "type": type, "size": size, "price": price, "total": total, "time": time, "epoch": epoch });
          }
        }
      } else {
        if (dev) { console.log(tradeHistory); }        
        for (market in tradeHistory) {
          for (trade in tradeHistory[market]) {
            var type = "<div class='sell'>{{ lang.history.type_sell }} <img src='{{ baseurl }}assets/img/arrow-down.svg'/></div>";
            var maker = tradeHistory[market][trade]["maker"];
            var taker = tradeHistory[market][trade]["taker"];
            var size = tradeHistory[market][trade]["size"] + " " + maker;
            var price = tradeHistory[market][trade]["price"];
            var total = tradeHistory[market][trade]["total"] + " " + taker;
            var time = tradeHistory[market][trade]["time"];
            var epoch = tradeHistory[market][trade]["epoch"];

            marketHistory.push({ "type": type, "size": size, "price": price, "total": total, "time": time, "epoch": epoch });
          }
        }
      }
      
      // sort trades by ascending time
      marketHistory.sort(function(a, b) {
        var epochA = Number(a.epoch);
        var epochB = Number(b.epoch);
        if (epochA < epochB) return 1;
        if (epochA > epochB) return -1;
        return 0;
      });

      // updateTable();
      if (dev) {
        console.log("============LOADING============");
        console.log("---MARKETS---");
        console.log(marketList);
        console.log("---ALL TRADES---");
        console.log(tradeHistory);
        console.log("---CURRENT MARKET---");
        console.log(currentMarket);
        console.log("---ASKS---");
        console.log(asks);
        console.log("---BIDS---");
        console.log(bids);
        console.log("---COMBINED---");
        console.log(marketHistory);
        console.log("============DONE============");
      }
      resolve();
    });
    return promise;
  }

  function updateTable() {
    if (dev) { console.log("updateTable"); }
    var historyTable = "";
    var tableHeader = "";
    // generate html table markup with orders
    console.log("marketHistory.length: " + marketHistory.length);
    if (marketHistory == undefined || marketHistory.length == 0) {
      historyTable = "<tr><td>" + noTradesMsg + "</td><td></td><td></td><td></td><td></td><tr>";
    } else {
      for (trade in marketHistory) {
        historyTable += "<tr><td>" + marketHistory[trade]["type"] + "</td><td>" + marketHistory[trade]["size"] + "</td><td>" + marketHistory[trade]["price"] + "</td><td>" + marketHistory[trade]["total"] + "</td><td>" + marketHistory[trade]["time"] + "</td><tr>";
      }
    }
    // update table body with orders
    document.getElementById("dx-tbody-hist").innerHTML = historyTable;
    // update table headers
    if (getMarket() !== "all") {
      var marketMaker = targetMarket.split("/")[0];
      var marketTaker = targetMarket.split("/")[1];
      // update table headers with units
      document.querySelectorAll('.market-maker').forEach((element, index, array) => {
          element.innerHTML = " (" + marketMaker + ")";
      })
      document.querySelectorAll('.market-taker').forEach((element, index, array) => {
          element.innerHTML = " (" + marketTaker + ")";
      })
    } else {
      // update table headers to remove units
      document.querySelectorAll('.market-maker').forEach((element, index, array) => {
          element.innerHTML = "";
      })
      document.querySelectorAll('.market-taker').forEach((element, index, array) => {
          element.innerHTML = "";
      })
    }
    console.log("History table loaded");
  }


  // update embedded twitter feed
  setTimeout(function(){
    if (window.__twttr&&window.__twttr.widgets&&window.__twttr.widgets.loaded&&window.twttr.widgets.load&&window.twttr.widgets.load(),window.__twttr&&window.__twttr.widgets&&window.__twttr.widgets.init) {
      [].slice.call(document.querySelectorAll('iframe.twitter-timeline')).forEach(function(e,i,a){
        // update header
        var header = e.contentDocument.getElementsByClassName('timeline-Header-title');
        var title = '{{ lang.history.stats_subheader }}';
        var newHeader = title + '<span class="timeline-Header-byline" data-scribe="element:byline"> by <a class="customisable-highlight" href="https://twitter.com/DxStats" title="‎@DxStats on Twitter">‎@DxStats</a></span>';
        header[0].innerHTML = newHeader;
        // update font size
        var tweets = e.contentDocument.getElementsByClassName('timeline-Tweet-text');
        for (tweet in tweets) {
          tweets[tweet].style.fontSize = '1.1rem';
        }
      });
    } 
  }, 1800);

</script>

